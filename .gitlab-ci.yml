# .gitlab-ci.yml
image: maven:3.8.7-eclipse-temurin-17

services:
  - postgres:14

variables:
  POSTGRES_DB: testdb
  POSTGRES_USER: testuser
  POSTGRES_PASSWORD: testpass

stages:
  - test

before_script:
  - export SPRING_DATASOURCE_URL="jdbc:postgresql://postgres:5432/$POSTGRES_DB"
  - export SPRING_DATASOURCE_USERNAME=$POSTGRES_USER
  - export SPRING_DATASOURCE_PASSWORD=$POSTGRES_PASSWORD

test:
  stage: test
  script:
    - mvn clean test
